"use strict";$(function(){function a(a){for(var s=decodeURIComponent(location.search.slice(1)).split("&"),t=0;t<s.length;t++){var e=s[t].split("=");if(a==e[0])return e[1]}}var s=a("clid"),t=a("name");$(".head_link").find("a").eq(2).html(t);var i=0,e=1,n="price",c="desc";function o(a){if("0"==a.code){var s=a.datalist.map(function(a){var s=a.bigimg.split("-")[0];return'<li data-id="'+a.gid+'">\n                            <div class="good_img">\n                                <img src="'+s+'" alt="">\n                            </div>\n                            <div class="good_mess">\n            <p class="good_price">￥'+a.price+"<del>￥"+a.delprice+'</del></p>\n                                <p class="good_name">'+a.goodname+"</p>\n                            </div>\n                        </li>"}).join("");$(".list_content .list").html(s)}}function p(){e<=1?$(".prev").css("color","#CCCCCC"):$(".prev").css("color","#A2193F"),i<=e?$(".next").css("color","#CCCCCC"):$(".next").css("color","#A2193F"),$(".page_btn .pages").find("a").removeClass("a_active"),$(".page_btn .pages").find("a").eq(e-1).addClass("a_active"),$(".sort_r .page").find(".num").html(e)}0==s?$.ajax({type:"GET",cache:!1,url:"../api/goodlist.php",data:{page:1,nums:40,type:"gid",order:"asc"},success:function(a){var s=JSON.parse(a);o(s);var t="";if(1<(i=Math.ceil(s.total/40))){for(var e=1;e<=i;e++)t+='<a href="javascript:;">'+e+"</a>";3<i&&(t+="<span>...</span>")}else t='<a href="javascript:;">1</a>';p(),$(".page_btn .pages").html(t),$(".page_btn .pages").find("a").eq(0).addClass("a_active"),$(".sort_r .total").find("span").html(s.total),$(".sort_r .page").find(".topPages").html(i)}}):$.ajax({type:"GET",cache:!1,url:"../api/classgood.php",data:{page:1,nums:40,type:"gid",order:"asc",clid:s},success:function(a){var s=JSON.parse(a);o(s);var t=Math.ceil(s.total/40),e="";if(1<t)if(3<t){for(var i=1;i<=3;i++)e+='<a href="javascript:;">'+i+"</a>";e+="<span>...</span>"}else for(i=1;i<=t;i++)e+='<a href="javascript:;">'+i+"</a>";else e='<a href="javascript:;">1</a>',$(".prev").css("display","none"),$(".next").css("display","none");p(),$(".page_btn .pages").html(e),$(".page_btn .pages").find("a").eq(0).addClass("a_active"),$(".sort_r .total").find("span").html(s.total),$(".sort_r .page").find(".topPages").html(t)}}),$(".sort_l dd").data("key",!1),$(".sort_l .default").click(function(){$(this).data("key")&&$.ajax({type:"GET",cache:!1,url:"../api/goodlist.php",data:{page:1,nums:40,type:"gid",order:"asc"},success:function(a){$(this).addClass("default_active"),$(this).data("key",!1),$(this).siblings().removeClass("sort_activeUp"),$(this).siblings().removeClass("sort_activeDown"),o(JSON.parse(a)),e=1,p(),$(".page_btn .pages").find("a").removeClass("a_active"),$(".page_btn .pages").find("a").eq(0).addClass("a_active")}.bind($(this))})}),$(".sort_l .sort_btn").click(function(){n=$(this).hasClass("sales")?"xiaoliang":"price",c=$(this).data("key")?"asc":"desc",$.ajax({type:"GET",cache:!1,url:"../api/goodlist.php",data:{page:1,nums:40,type:n,order:c},success:function(a){$(".sort_l .default").data("key",!0),$(this).data("key",!$(this).data("key")),o(JSON.parse(a)),"desc"==c?($(this).removeClass("sort_activeUp"),$(this).addClass("sort_activeDown")):($(this).removeClass("sort_activeDown"),$(this).addClass("sort_activeUp")),e=1,p(),$(".page_btn .pages").find("a").removeClass("a_active"),$(".page_btn .pages").find("a").eq(0).addClass("a_active"),$(this).siblings().removeClass("sort_activeUp"),$(this).siblings().removeClass("sort_activeDown"),$(this).siblings().removeClass("default_active")}.bind($(this))})}),$(".prev").click(function(){1<e&&$.ajax({type:"GET",cache:!1,url:"../api/goodlist.php",data:{page:--e,nums:40,type:n,order:c},success:function(a){o(JSON.parse(a)),p()}})}),$(".next").click(function(){e<i&&$.ajax({type:"GET",cache:!1,url:"../api/goodlist.php",data:{page:++e,nums:40,type:n,order:c},success:function(a){o(JSON.parse(a)),p()}})}),$(".page_btn .pages").on("click","a",function(){$(this).hasClass("a_active")||$.ajax({type:"GET",cache:!1,url:"../api/goodlist.php",data:{page:1*$(this).index()+1,nums:40,type:n,order:c},success:function(a){var s=JSON.parse(a);e=$(this).index()+1,o(s),p(),console.log(i,e)}.bind($(this))})}),$(".list_content .list").on("click","li",function(){var a=$(this).attr("data-id");window.open("../html/details.html?gid="+a)})});